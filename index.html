<!DOCTYPE html>
<html>

<body>
	<button>Open reports for this week</button>
</body>
<script>
	const urls = [
		new URL("https://jamesriver.fellowshiponego.com/reports/attendance/individual?people=attendees&groups[]=178&groups[]=179&groups[]=181&dateRangeType=custom&attendanceRange=present&savedReportId=216"),
		new URL("https://jamesriver.fellowshiponego.com/reports/attendance/individual?people=attendees&groups[]=195&groups[]=196&groups[]=198&dateRangeType=custom&attendanceRange=present&savedReportId=217"),
		new URL("https://jamesriver.fellowshiponego.com/reports/attendance/individual?people=attendees&groups[]=135&groups[]=136&groups[]=138&dateRangeType=custom&attendanceRange=present&savedReportId=219"),
		new URL("https://jamesriver.fellowshiponego.com/reports/attendance/individual?people=attendees&groups[]=142&groups[]=143&groups[]=165&dateRangeType=custom&attendanceRange=present&savedReportId=218"),
	];

	const Day = Object.freeze({
		SUNDAY: 0,
		MONDAY: 1,
		TUESDAY: 2,
		WEDNESDAY: 3,
		THURSDAY: 4,
		FRIDAY: 5,
		SATURDAY: 6,
	});

	function getLastWeekday(targetDate, day) {
		const currentWeekday = targetDate.getDay();
		const daysToSubtract = 7 + ((currentWeekday - day + 7) % 7);
		const lastWeekdayDate = new Date(targetDate);
		lastWeekdayDate.setDate(targetDate.getDate() - daysToSubtract);
		return lastWeekdayDate;
	}

	const button = document.querySelector("button");
	button.addEventListener("click", (evt) => {
		const lastMonday = getLastWeekday(new Date(), Day.MONDAY);
		const startDate = date.toLocaleDateString();
		// Last Sunday
		date.setDate(date.getDate() + 6);
		const endDate = date.toLocaleDateString();
		for (const url of urls) {
			url.searchParams.set("startDate", startDate);
			url.searchParams.set("endDate", endDate);
			window.open(url.href, "_blank");
		}
	});
</script>

</html>
